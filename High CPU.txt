event manager applet HIGH_CPU authorization bypass
 event snmp oid 1.3.6.1.4.1.9.9.109.1.1.1.1.3.1 get-type exact entry-op ge entry-val "85" exit-op lt exit-val "75" poll-interval 1
 action 1.01 syslog msg "------HIGH CPU DETECTED----, CPU:$_snmp_oid_val%"
 action 1.02 cli command "enable"
 action 1.03 cli command "term length 0"
 action 1.04 cli command "debug netdr cap rx"
 action 1.06 cli command "show proc cpu sort | append bootdisk:HIGH_CPU.txt"
 action 1.07 cli command "Show users | append bootdisk:HIGH_CPU.txt"
 action 1.08 cli command "Show proc cpu history | append bootdisk:HIGH_CPU.txt"
 action 1.09 cli command "show logging | append bootdisk:HIGH_CPU.txt"
 action 1.10 cli command "show spanning-tree detail | append bootdisk:HIGH_CPU.txt"
 action 1.11 cli command "show ip traffic | append bootdisk:HIGH_CPU.txt"
 action 1.12 cli command "show clock | append bootdisk:HIGH_CPU.txt"
 action 1.13 wait 5
 action 1.14 cli command "show netdr cap | append bootdisk:HIGH_CPU.txt"
 action 1.15 cli command "undebug all"
 action 1.16 cli command "show flow mon | append bootdisk:HIGH_CPU.txt"
 action 1.17 cli command "show flow exporter statistics | append bootdisk:HIGH_CPU.txt"
 action 1.18 cli command "show platform hardware capacity netflow | append bootdisk:HIGH_CPU.txt"
 action 1.19 cli command "show platform flow table-contention summ | append bootdisk:HIGH_CPU.txt"
 action 1.20 cli command "show platform flow table-contention detail | append bootdisk:HIGH_CPU.txt"
 action 1.21 cli command "show platform flow table-contention agg | append bootdisk:HIGH_CPU.txt"
 action 1.22 cli command "term length 24"
 action 1.23 syslog msg "------outputs have been obtained. Please check bootdisk:HIGH_CPU.txt----"
 action 1.24 cli command "exit"
!